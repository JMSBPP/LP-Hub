"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const expect_1 = require("./shared/expect");
const hardhat_1 = require("hardhat");
const hardhat_network_helpers_1 = require("@nomicfoundation/hardhat-network-helpers");
const snapshotGasCost_1 = __importDefault(require("./shared/snapshotGasCost"));
describe('LiquidityMath', () => {
    let liquidityMath;
    const fixture = async () => {
        const factory = await hardhat_1.ethers.getContractFactory('LiquidityMathTest');
        return (await factory.deploy());
    };
    beforeEach('deploy LiquidityMathTest', async () => {
        liquidityMath = await (0, hardhat_network_helpers_1.loadFixture)(fixture);
    });
    describe('#addDelta', () => {
        it('1 + 0', async () => {
            (0, expect_1.expect)(await liquidityMath.addDelta(1, 0)).to.eq(1);
        });
        it('1 + -1', async () => {
            (0, expect_1.expect)(await liquidityMath.addDelta(1, -1)).to.eq(0);
        });
        it('1 + 1', async () => {
            (0, expect_1.expect)(await liquidityMath.addDelta(1, 1)).to.eq(2);
        });
        it('2**128-15 + 15 overflows', async () => {
            await (0, expect_1.expect)(liquidityMath.addDelta(2n ** 128n - 15n, 15)).to.be.revertedWithCustomError(liquidityMath, 'liquidityAdd');
        });
        it('0 + -1 underflows', async () => {
            await (0, expect_1.expect)(liquidityMath.addDelta(0, -1)).to.be.revertedWithCustomError(liquidityMath, 'liquiditySub');
        });
        it('3 + -4 underflows', async () => {
            await (0, expect_1.expect)(liquidityMath.addDelta(3, -4)).to.be.revertedWithCustomError(liquidityMath, 'liquiditySub');
        });
        it('gas add  [ @skip-on-coverage ]', async () => {
            await (0, snapshotGasCost_1.default)(liquidityMath.getGasCostOfAddDelta(15, 4));
        });
        it('gas sub  [ @skip-on-coverage ]', async () => {
            await (0, snapshotGasCost_1.default)(liquidityMath.getGasCostOfAddDelta(15, -4));
        });
    });
});
